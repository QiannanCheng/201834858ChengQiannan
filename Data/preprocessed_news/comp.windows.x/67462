from sinclair dcs.glasgow.ac.uk duncan sinclair subject glasgow rx remot execut x program part i post few week back all i got back error messag pnew dev null permiss deni yep dev null had mode arrghhh renew interest set displai variabl etc i thought i would post my contribut perl script my solut try intellig about what it' do so you should abl type rx host.domain.etc get xterm run host.domain.etc all difficult stuff taken care theori program can do everyth you ever want do when you want run remot command background doesn't even need x program try rx big machin make instanc background make remot big machin more detail full list featur read readm file about line below all comment welcom duncan bin sh shell archiv remov anyth befor line unpack save file type sh file overwrit exist file type sh file c you can also feed standard input via unshar type sh file e.g archiv complet you see follow messag end end archiv content readm imakefil manifest makefil rx.man rx.pl wrap sinclair dcs.gla.ac.uk thu apr path bin usr bin usr ucb export path test f readm c echo shar clobber exist file readm els echo shar extract readm charact sed s x readm end_of_fil x x glasgow rx remot execut x program version x xcopyright duncan sinclair sinclair dcs.gla.ac.uk x xtrivial instal there' imakefil make even more trivial x xthe perl script need some customis befor instal just xedit rx.pl file read comment onc you'v done xthi you can xmkmf make instal install.man x xfeatur x x doe right thing off site remot execut includ x set up displai includ domain name pass x magic cooki do xhost stuff x x allow differ remot user name rx l user host x x smart quot argument make pass wild card easi x x custom command execut link remac get remot x emac command x x automat xterm option name xterm accord hostnam x turn login shell x x default command xterm x x propag x ish env variabl remot session user mai x extend list variabl pass x x special handl bourn shell user x x tri do remot execut from same directori local x propag pwd intellig manner x x log error file x x overal intellig tm make reason decis about what x you try do tri do right thing x x written perl portabl hackabl x xfor more info read man page sourc x end_of_fil test ne wc c readm echo shar readm unpack wrong size fi end readm fi test f imakefil c echo shar clobber exist file imakefil els echo shar extract imakefil charact sed s x imakefil end_of_fil x glasgow rx imakefil x x program rx x xall program x xinstal safe x xinstallnamedprog rx.pl rx bindir xinstallmanpag rx mandir x xinstal x rm bindir rxterm x ln bindir rx bindir rxterm x xsafe x grep s debug rx.pl fals x xshar safe x makekit m p x perl pi e s sinclair dcs.gla.ac.uk sinclair dcs.gla.ac.uk part x end_of_fil test ne wc c imakefil echo shar imakefil unpack wrong size fi end imakefil fi test f manifest c echo shar clobber exist file manifest els echo shar extract manifest charact sed s x manifest end_of_fil x file name archiv descript x x readm read me first x imakefil x manifest ship list x makefil x rx.man x rx.pl end_of_fil test ne wc c manifest echo shar manifest unpack wrong size fi end manifest fi test f makefil c echo shar clobber exist file makefil els echo shar extract makefil charact sed s x makefil end_of_fil x makefil gener imak do edit x xconsortium imake.c v rw exp x x cpp us machin replac all newlin multipl tab x space macro expans singl space imak tri compens x alwai success x x x x makefil gener from imake.tmpl tmp iif.a x xconsortium imake.tmpl v rw exp x x platform specif paramet mai set appropri vendor cf x configur file site specif paramet should set file x site.def full rebuild recommend ani paramet chang x x your c preprocessor doe defin ani uniqu symbol you need x set bootstrapcflag when rebuild imak usual when do x make world first time x x x x site specif configur paramet need come befor x platform specif paramet edit site.def chang x x site xconsortium site.def v rw exp x x x platform specif configur paramet edit sun.cf chang x x platform xconsortium sun.cf v rw exp x x oper system suno x x xconsortium sunlib.rul v rw exp x x x site specif configur paramet go after x platform specif paramet edit site.def chang x x site xconsortium site.def v rw exp x x shell bin sh x x top x current_dir x x ar ar cq x bootstrapcflag x cc gcc fpcc struct return x x x compress compress x cpp lib cpp std_cpp_defin x preprocesscmd gcc fpcc struct return e std_cpp_defin x instal instal x ld ld x lint lint x lintlibflag c x lintopt axz x ln ln s x make make x mv mv x cp cp x x ranlib ranlib x ranlibinstflag x x rm rm f x troff psroff x msmacro ms x tbl tbl x eqn eqn x std_includ x std_cpp_defin x std_defin x extra_load_flag x extra_librari x tag ctag x x sharedcodedef dsharedcod x shlibdef dsunshlib x x proto_defin x x instpgmflag x x instbinflag m x instuidflag m x instlibflag m x instincflag m x instmanflag m x instdatflag m x instkmemflag g kmem m x x projectroot usr x x x top_includ i incroot x x cdebugflag o x ccoption x x allinclud includ extra_includ top_includ std_includ x alldefin allinclud std_defin extra_defin proto_defin defin x cflag cdebugflag ccoption alldefin x lintflag lintopt dlint alldefin x x ldlib sys_librari extra_librari x x ldoption cdebugflag ccoption local_ldflag l usrlibdir x x ldcombineflag x r x dependflag x x macrofil sun.cf x rm_cmd rm ckp ln bak bak o core err emacs_ tag tag make.log makeout x x imake_defin x x irulesrc configdir x imake_cmd imak duseinstal i irulesrc imake_defin x x iconfigfil irulesrc imake.tmpl irulesrc imake.rul x irulesrc project.tmpl irulesrc site.def x irulesrc macrofil extra_iconfigfil x x x x window system build paramet x xconsortium project.tmpl v rw exp x x x x window system make variabl need coordin rule x x pathsep x usrlibdir usr x lib x bindir usr x local bin x incroot usr x includ x buildincroot top x buildincdir buildincroot x x buildinctop x incdir incroot x x admdir usr adm x libdir usrlibdir x x configdir libdir config x lintlibdir usrlibdir lint x x fontdir libdir font x xinitdir libdir xinit x xdmdir libdir xdm x twmdir libdir twm x manpath usr x man x mansourcepath manpath man x mansuffix n x libmansuffix x mandir mansourcepath mansuffix x libmandir mansourcepath libmansuffix x nlsdir libdir nl x pexapidir libdir pex x xapploaddir libdir app default x fontcflag t x x instappflag instdatflag x x imak imak x depend makedepend x rgb rgb x x fontc bdftopcf x x mkfontdir mkfontdir x mkdirhier bin sh bindir mkdirhier x x configsrc top config x docutilsrc top doc util x clientsrc top client x demosrc top demo x libsrc top lib x fontsrc top font x includesrc top x x serversrc top server x utilsrc top util x scriptsrc utilsrc script x examplesrc top exampl x contribsrc top contrib x docsrc top doc x rgbsrc top rgb x dependsrc utilsrc makedepend x imakesrc configsrc x xauthsrc libsrc xau x xlibsrc libsrc x x xmusrc libsrc xmu x toolkitsrc libsrc xt x awidgetsrc libsrc xaw x oldxlibsrc libsrc oldx x xdmcplibsrc libsrc xdmcp x bdftosnfsrc fontsrc bdftosnf x bdftosnfsrc fontsrc client bdftosnf x bdftopcfsrc fontsrc client bdftopcf x mkfontdirsrc fontsrc client mkfontdir x fslibsrc fontsrc lib fs x fontserversrc fontsrc server x extensionsrc top extens x xilibsrc extensionsrc lib xinput x pexlibsrc extensionsrc lib pexlib x phigslibsrc extensionsrc lib pex x x xconsortium sunlib.tmpl v rw exp x xshlibldflag assert pure text xpicflag fpic x x depextensionlib x extensionlib lxext x x depxlib depextensionlib x xlib extensionlib lx x x depxmulib usrlibdir libxmu.sa soxmurev x xmulibonli lxmu x xmulib lxmu x x depoldxlib x oldxlib loldx x x depxtoollib usrlibdir libxt.sa soxtrev x xtoollib lxt x x depxawlib usrlibdir libxaw.sa soxawrev x xawlib lxaw x x depxilib x xilib lxi x x deppexlib x pexlib lpex x x soxlibrev x soxtrev x soxawrev x sooldxrev x soxmurev x soxextrev x soxinputrev x sopexrev x x depxauthlib usrlibdir libxau.a x xauthlib lxau x depxdmcplib usrlibdir libxdmcp.a x xdmcplib lxdmcp x x depphigslib usrlibdir libphigs.a x phigslib lphig x x depxbsdlib usrlibdir libxbsd.a x xbsdlib lxbsd x x lintextensionlib lintlibdir llib lxext.ln x lintxlib lintlibdir llib lx ln x lintxmu lintlibdir llib lxmu.ln x lintxtool lintlibdir llib lxt.ln x lintxaw lintlibdir llib lxaw.ln x lintxi lintlibdir llib lxi.ln x lintpex lintlibdir llib lpex ln x lintphig lintlibdir llib lphigs.ln x x deplib depxawlib depxmulib depxtoollib depxlib x x deplib deplib x deplib deplib x deplib deplib x x x imak rule build librari program script data file x rule xconsortium imake.rul v rw exp x x x start imakefil x x glasgow rx imakefil x x program rx x xall program x xinstal safe x xinstal rx.pl x d destdir bindir set x x els set x mkdirhier destdir bindir fi x instal c instbinflag rx.pl destdir bindir rx x xinstall.man rx.man x d destdir mandir set x x els set x mkdirhier destdir mandir fi x instal c instmanflag rx.man destdir mandir rx mansuffix x xinstal x rm bindir rxterm x ln bindir rx bindir rxterm x xsafe x grep s debug rx.pl fals x xshar safe x makekit m p x perl pi e s sinclair dcs.gla.ac.uk sinclair dcs.gla.ac.uk part x x x common rule all makefil do edit x xemptyrul x xclean x rm_cmd x xmakefil x f makefil set x x rm makefile.bak mv makefil makefile.bak x els exit fi x imake_cmd dtopdir top dcurdir current_dir x xtag x tag w ch x tag xw ch tag x xsaber x load alldefin src x xosab x load alldefin obj x x x empti rule directori do have subdir do edit x xinstal x echo instal current_dir done x xinstall.man x echo install.man current_dir done x xmakefil x xinclud x x x depend gener makedepend x end_of_fil test ne wc c makefil echo shar makefil unpack wrong size fi end makefil fi test f rx.man c echo shar clobber exist file rx.man els echo shar extract rx.man charact sed s x rx.man end_of_fil x.th rx march x version x.sh name xrx rxterm r remot command xterm anyth execut x.sh synopsi x.b rx x x.b l x.i usernam x x.i host x x.i command x x.br x.b rxterm x x.b l x.i usernam x x.i host x x.ir arg x x.sh descript xthe x.b rx xprogram connect specifi x.i host xand execut specifi x.i command xin background return immedi allow execut xof x program copi number environment variabl xthe remot session you omit x.ir command xthen rx start xterm remot host x.b rxterm xvarient start remot xterm host also pass x.i arg xto remot xterm argument x.pp xshell metacharact which quot interpret local xmachin while quot metacharact interpret remot xmachin x.pp xif name file from which x.b rx xi execut anyth other than rx x.b rx xtake name strip lead r command xto run remot host us ani x.i command xparamet argument remot command x.pp xif x.b rx xthink you us x.b xauth xbase x authoris you call off site host xto differ usernam attempt copi author xkei remot account otherwis try us x.b xhost xto grant access remot host x.sh option x.tp x.bi l usernam xuse x.i usernam xa remot usernam instead your local usernam absenc xof option remot usernam same your local usernam x x.sh environ xif set valu path displai xenviron xapplresdir xxfilesearchpath xuserfilesearchpath openwinhom ld_library_path xand xauthor export remot program unless xremot usernam differ remot host off site which xcase onli displai export all case ani variabl name xvariabl rxenv x.pp xthe displai variabl tweak appropri contain qualifi xa hostnam need x.sh diagnost x.tp x.ib command don't recognis my name x.b rx xcannot decod name ha been call under case xit print warn messag continu normal x.tp x.b rx usag rx l usernam hostnam arg xthi mean could decod argument given x.sh author xduncan sinclair sinclair dcs.glasgow.ac.uk juli x.br xorigin base program same name from x.b gwm xdistribut distinguish rx from other program xwith similar name you should refer program x.b glasgow x.br rx x.sh see also xx rsh xterm xauth xhost gwm x.sh bug x.b rx xmake number assumpt about relationship between xlocal user remot on depend whether remot xhost onsit whether altern usernam us xor x.pp xin particular either local us shell remot xuse shell standard bourn shell x.b sh xthen strang thing more like happen especi when xit' onli on them x.pp xsometim quot can get mess up x.pp xit' too easi fool smart x.b rx xto make believ someth true fail becaus x.pp xwhen x.b rx xuse x.b xhost xto grant access x.b xhost xcommand mai fail silent x.pp xif x.b rx xtri send larg command remot machin xlike fail pars error from csh happen you xwill probabl have reduc size export environ end_of_fil test ne wc c rx.man echo shar rx.man unpack wrong size fi end rx.man fi test f rx.pl c echo shar clobber exist file rx.pl els echo shar extract rx.pl charact sed s x rx.pl end_of_fil x usr local bin perl x config chang line abov point your copi perl x x glasgow rx version x x copyright duncan sinclair sinclair dcs.gla.ac.uk x x last modifi earli april x x distribut limit per usual mit copyright x x remot execut x program base script old version gwm x x instal put rx your bin make rxterm link x some configur necessari see config comment x x more more less less like origin x x major hack work our my set up also partli x re written work sh rather than ksh x x mayb i'll turn our first zsh script x x look like turn perl script some point big improv x x code tri intellig wai work mean x ton implicit assumpt about environ run x assumpt all valid machin i us my x environ same time i try make few assumpt possibl x about remot machin here' list all more tricki on x remot machin ha csh linux x rshell bin k sh remot shell bin k sh make same x remot shell sh path compat us csh etc x i pass cooki remot machin need doe x know what do cooki eat x must other x x why am i us csh run remot command simpli becaus doesn't x interact badli rsh hang wait file descriptor x close i'd rather us zsh bash even perl x univers csh x x xrequir stat.pl x x what we call x x argv x argv s x x config x chang variabl your domain name pattern x match all variat your domain name you must includ x those lead dot your hostnam includ your domain see x code further down mark xxx x x dom dcs.gla.ac.uk x dompat dc gla sgow ac uk x x config x chang your valu bindir set variabl x you think your user smarter than x x xpath usr x bin x x config x make name your remot shell command x x rsh rsh x x end config x x some variabl we'll doubt us sometim x x usag argv usag argv l usernam hostnam arg n x rshell getpwuid bin sh x home env home getpwuid x xauth env xauthor home xauthor x logf rx.log x stuff x debug x x befor anyth els close stdin might stop rx hang x due rsh weird x xclose stdin x x do l flag x xif argv eq l x shift x user argv die usag x luser l user x shift x x x pick host ani host x x mach argv die usag xshift x x thing think about remot machin x x mach s dompat x offsit mach x x where am i seem we can't trust dumb user set hostnam right x x hostnam env hostnam hostnam current host x hostnam hostnam current host x hostnam s n x x all your hostnam includ your domain comment out next line x xif offsit hostnam hostnam dom xxx x x now we know where we differ x x diff hostnam ne mach x x what displai go x danger heavi regular express follow x need re written modular can so extend x support reset host unix requir x x displai env displai x displai s dompat x displai s unix d d hostnam diff x displai s d d dom offsit x env displai displai x x here come hard bit sh quot our arg x also have quot quot cope csh braindamag x quot quot thu x so arg foo'bar we get foo bar x xforeach argv x s g x s x x x so what we do x xprog x argv eq rx last prog x argv eq rxterm x unshift argv ls diff x unshift argv xterm ls n mach x last prog x x argv r unshift argv last prog x warn argv don't recognis my name x x x noth els becom rxterm x xif argv x unshift argv ls diff x unshift argv xterm ls n mach x x x some special consider we ourselv other side x xif offsit user x x we want pass cooki here x x e xauth x x go unsecur cooki appear number x command line arg least it'll work x need enhanc we ever fix code abov x set displai when we return server x x cooki path path xpath xauth list displai x chop cooki x cook split cooki x shift cook x unshift stuff xauth add displai cook cook x els x x yuk what crock i hate do x x system xhost mach dev null dev null diff x x x we realli onli want pass valu displai x x var displai split env rxenv x els x x some variabl we wish export x x var x displai x xenviron x xfilesearchpath x xuserfilesearchpath x xapplresdir x openwinhom x ld_library_path x manpath rxman bourn shell user x xauthor x split env rxenv x x x braindead bourn shell need given path x we would rather pass current path becaus might work x destin machin i'd rather set user' x remot shell dure rsh x fortun all my x program arch independ place x so shouldn't co problem local x we check against rshell becaus might run anoth shell x differ from login shell i know sound weird it' too x common round here x i'v also includ ksh brain damag co i can't see easi wai x pass throught env env without be too late we onli have x on person who ha ksh login shell anywai x oh yeah we assum it' bourn shell here it' x bourn shell much more import than isnt x bourn shell here better bourn shell x x rshell m k sh push var path x x x valid pwd routin x xsub validate_pwd x local pwdstat dotstat x local pwd x x unless defin pwd return undef x unless dotstat stat return undef x unless pwdstat stat pwd return undef x pwdstat st_dev dotstat st_dev x pwdstat st_ino dotstat st_ino return undef x pwd x x x try find nice valid pwd x xpresent x pwd env pwd x foopwd pwd x foopwd s tmp_mnt export x pwd validate_pwd foopwd validate_pwd pwd x x unless pwd x chop pwd pwd x foopwd pwd x foopwd s tmp_mnt export x pwd validate_pwd foopwd validate_pwd pwd home x x x pwd s x x try find somewher nice live other side x xunless offsit x unshift stuff test d pwd cd pwd x x x start build full command x xforeach var var x val env var x unshift stuff setenv var val x x x some command do other side x xunshift stuff set nonomatch onli we us csh x x build remot command x x remot umask join stuff argv dev null logf x remot s g x remot remot x x build arg list exec x x comm rsh luser mach csh fc remot x x do x xif debug x print comm n x els x exec comm x x x rsh doesn't return ani indic how went over x other side that' ok co we aint go x wait around see what happen x xexit x x end end_of_fil test ne wc c rx.pl echo shar rx.pl unpack wrong size fi chmod x rx.pl end rx.pl fi echo shar end archiv cp dev null ark isdon miss i do test f ark i isdon miss miss i fi done test miss echo you have archiv rm f ark isdon els echo you still need unpack follow archiv echo miss fi end shell archiv exit duncan sinclair sinclair dcs.gla.ac.uk sinclair uk.ac.gla.dc would real unix oper system pleas stand up 